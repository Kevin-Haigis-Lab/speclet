"""My colors and color palettes."""

from typing import Any, Mapping

from matplotlib.lines import Line2D

name = str
color = str
RGB = tuple[float, float, float]
RGBA = tuple[float, float, float, float]
ColorPalette = Mapping[name, color | RGB | RGBA]


def lineage_color_pal() -> dict[str, RGB]:
    """Lineage color palette."""
    return {
        "bile duct": (0.15294117647058825, 0.29411764705882354, 0.6941176470588235),
        "blood": (0.10065359477124183, 0.39869281045751637, 0.7986928104575164),
        "bone": (0.04836601307189542, 0.5032679738562091, 0.9032679738562092),
        "breast": (0.0, 0.6058823529411764, 0.9823529411764705),
        "central nervous system": (0.0, 0.6843137254901961, 0.747058823529412),
        "cervix": (0.0, 0.7627450980392158, 0.5117647058823529),
        "colorectal": (0.06666666666666667, 0.8133333333333334, 0.41333333333333333),
        "esophagus": (0.2235294117647059, 0.8447058823529412, 0.4447058823529412),
        "eye": (0.3803921568627451, 0.876078431372549, 0.476078431372549),
        "gastric": (0.5372549019607841, 0.9074509803921569, 0.5074509803921569),
        "kidney": (0.6941176470588235, 0.9388235294117647, 0.5388235294117647),
        "liver": (0.8509803921568627, 0.9701960784313726, 0.5701960784313725),
        "lung": (0.996078431372549, 0.9949803921568627, 0.5978823529411764),
        "lymphocyte": (0.9254901960784314, 0.9046274509803922, 0.5597647058823529),
        "ovary": (0.8470588235294118, 0.804235294117647, 0.5174117647058823),
        "pancreas": (0.7686274509803921, 0.7038431372549019, 0.47505882352941176),
        "peripheral nervous system": (
            0.6901960784313725,
            0.6034509803921568,
            0.43270588235294116,
        ),
        "plasma cell": (0.611764705882353, 0.5030588235294118, 0.39035294117647057),
        "prostate": (0.5333333333333333, 0.4026666666666666, 0.34800000000000003),
        "skin": (0.5372549019607841, 0.4076862745098036, 0.3799215686274507),
        "soft tissue": (0.615686274509804, 0.508078431372549, 0.48501960784313725),
        "thyroid": (0.6941176470588235, 0.6084705882352941, 0.5901176470588235),
        "upper aerodigestive": (
            0.7725490196078431,
            0.7088627450980391,
            0.6952156862745098,
        ),
        "urinary tract": (0.8509803921568627, 0.8092549019607842, 0.800313725490196),
        "uterus": (0.9294117647058824, 0.9096470588235294, 0.9054117647058824),
    }


def lineage_color_pal_short() -> dict[str, RGB]:
    """Lineage color palette with shortened lineage names."""
    mod_names = {
        "central nervous system": "CNS",
        "peripheral nervous system": "PNS",
        "upper aerodigestive": "upper aero.",
    }
    mod_pal = {}
    for ln, color in lineage_color_pal().items():
        ln_mod = mod_names.get(ln, ln)
        mod_pal[ln_mod] = color
    return mod_pal


def sublineage_color_pal() -> dict[str, RGB]:
    """Sublineage color palette."""
    return {
        "bile duct (cholangiocarcinoma)": (
            0.6618992695117263,
            0.050826605151864664,
            0.26881968473663975,
        ),
        "bile duct (gallbladder adenocarcinoma)": (
            0.7126489811610919,
            0.10711264898116109,
            0.28081507112648985,
        ),
        "blood (ALL)": (0.7633986928104575, 0.1633986928104575, 0.2928104575163399),
        "blood (AML)": (0.8141484044598232, 0.2196847366397539, 0.3048058439061899),
        "blood (CLL)": (0.8519800076893502, 0.26843521722414454, 0.3033448673587082),
        "blood (CML)": (0.8758169934640523, 0.3045751633986928, 0.29411764705882354),
        "bone (Ewing sarcoma)": (
            0.9044213763936948,
            0.34794309880815066,
            0.28304498269896194,
        ),
        "bone (chordoma)": (
            0.9330257593233372,
            0.3913110342176086,
            0.27197231833910035,
        ),
        "bone (osteosarcoma)": (
            0.958246828143022,
            0.43744713571703187,
            0.267358708189158,
        ),
        "breast": (0.9665513264129182, 0.49742406766628217, 0.295040369088812),
        "central nervous system (glioma)": (
            0.9748558246828143,
            0.5574009996155325,
            0.32272202998846594,
        ),
        "central nervous system (medulloblastoma)": (
            0.9817762399077278,
            0.6073817762399076,
            0.3457900807381776,
        ),
        "cervix (cervical carcinoma)": (
            0.990080738177624,
            0.6673587081891579,
            0.37347174163783153,
        ),
        "cervix (cervical squamous)": (
            0.9928489042675894,
            0.716955017301038,
            0.40945790080738165,
        ),
        "colorectal": (0.9937716262975779, 0.7630911188004613, 0.44821222606689726),
        "esophagus (esophagus adenocarcinoma)": (
            0.9946943483275663,
            0.8092272202998846,
            0.48696655132641287,
        ),
        "esophagus (esophagus squamous)": (
            0.9954632833525567,
            0.8476739715494039,
            0.519261822376009,
        ),
        "eye (uveal melanoma)": (
            0.9963860053825452,
            0.8879661668589004,
            0.5610918877354863,
        ),
        "gastric (gastric adenocarcinoma)": (
            0.9973087274125336,
            0.9165705497885429,
            0.6090734332948865,
        ),
        "kidney (renal cell carcinoma)": (
            0.9982314494425221,
            0.9451749327181853,
            0.6570549788542868,
        ),
        "liver (hepatocellular carcinoma)": (
            0.9991541714725106,
            0.9737793156478277,
            0.7050365244136869,
        ),
        "lung (NSCLC)": (0.998077662437524, 0.9992310649750096, 0.7460207612456747),
        "lung (SCLC)": (0.9788542868127643, 0.9915417147251058, 0.7160322952710496),
        "lung (mesothelioma)": (
            0.9557862360630527,
            0.9823144944252211,
            0.6800461361014996,
        ),
        "lymphocyte (hodgkin lymphoma)": (
            0.932718185313341,
            0.9730872741253365,
            0.6440599769319494,
        ),
        "lymphocyte (lymphoma unspecified)": (
            0.9096501345636295,
            0.9638600538254518,
            0.6080738177623992,
        ),
        "lymphocyte (non hodgkin lymphoma)": (
            0.8656670511341794,
            0.9460207612456749,
            0.6034602076124567,
        ),
        "ovary (ovary adenocarcinoma)": (
            0.8202998846597465,
            0.9275663206459055,
            0.6126874279123413,
        ),
        "pancreas": (0.765859284890427, 0.9054209919261824, 0.623760092272203),
        "peripheral nervous system (neuroblastoma)": (
            0.7114186851211075,
            0.8832756632064592,
            0.6348327566320646,
        ),
        "plasma cell (multiple myeloma)": (
            0.6546712802768171,
            0.8604382929642448,
            0.6433679354094579,
        ),
        "prostate": (0.5910034602076126, 0.835524798154556, 0.6442906574394464),
        "skin (melanoma)": (0.5273356401384084, 0.8106113033448674, 0.6452133794694349),
        "skin (skin squamous)": (
            0.47427912341407163,
            0.7898500576701268,
            0.6459823144944252,
        ),
        "soft tissue (ATRT)": (
            0.4106113033448674,
            0.7649365628604383,
            0.6469050365244137,
        ),
        "soft tissue (liposarcoma)": (
            0.3600153787004998,
            0.7161860822760476,
            0.6655132641291811,
        ),
        "soft tissue (malignant rhabdoid tumor)": (
            0.31203383314109956,
            0.6626682045367166,
            0.6876585928489043,
        ),
        "soft tissue (rhabdomyosarcoma)": (
            0.26405228758169935,
            0.6091503267973857,
            0.7098039215686275,
        ),
        "soft tissue (synovial sarcoma)": (
            0.22406766628219915,
            0.564552095347943,
            0.7282583621683968,
        ),
        "thyroid (thyroid carcinoma)": (
            0.21299500192233756,
            0.5114186851211072,
            0.730795847750865,
        ),
        "upper aerodigestive": (
            0.25359477124183005,
            0.45882352941176474,
            0.7058823529411765,
        ),
        "urinary tract": (0.2941945405613224, 0.4062283737024224, 0.680968858131488),
        "uterus (endometrial adenocarcinoma)": (
            0.3347943098808151,
            0.35363321799307956,
            0.6560553633217993,
        ),
    }


def pal_to_legend_handles(color_pal: ColorPalette, **kwargs: Any) -> list[Line2D]:
    """Convert a palette into legend handles for matplotlib.

    Args:
        color_pal (ColorPalette): Color palette.

    Returns:
        list[Line2D]: Legend handles.
    """
    handles: list[Line2D] = []
    for lbl, color in color_pal.items():
        handles.append(Line2D([0], [0], label=lbl, color=color, **kwargs))
    return handles
